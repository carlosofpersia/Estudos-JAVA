package br.com.caelum.jdbc;

import java.sql.Connection;
import java.sql.SQLException;
import java.sql.Statement;

public class TestaRemocao {

	public Connection remove(Connection connection) throws SQLException {

		Statement statement = connection.createStatement();

		statement.execute("delete from Produto where id > 3");

		// getUpdateCount verifica quantas linhas foram atualizadas
		int count = statement.getUpdateCount();
		System.out.println(count + " linhas removidas");

		statement.close();
		return connection;
	}

	public static void main(String[] args) throws SQLException {

		Connection connection = Database.getConnection();
		TestaRemocao tr = new TestaRemocao();
		connection = tr.remove(connection);
		connection.close();
	}

}
